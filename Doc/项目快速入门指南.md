# Open Canvas é¡¹ç›®å¿«é€Ÿå…¥é—¨æŒ‡å—

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
3. [ç¯å¢ƒå‡†å¤‡](#ç¯å¢ƒå‡†å¤‡)
4. [å¿«é€Ÿå¯åŠ¨](#å¿«é€Ÿå¯åŠ¨)
5. [æ ¸å¿ƒæ¦‚å¿µ](#æ ¸å¿ƒæ¦‚å¿µ)
6. [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
7. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
8. [è¿›é˜¶å®šåˆ¶](#è¿›é˜¶å®šåˆ¶)

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

### ä»€ä¹ˆæ˜¯ Open Canvasï¼Ÿ

Open Canvas æ˜¯ä¸€ä¸ªå¼€æºçš„ AI åä½œå¹³å°ï¼Œçµæ„Ÿæ¥æºäº OpenAI çš„ Canvasï¼Œä½†å…·æœ‰ä»¥ä¸‹ç‹¬ç‰¹ä¼˜åŠ¿ï¼š

- **ğŸ”“ å®Œå…¨å¼€æº**: å‰ç«¯ã€åç«¯ã€AI ä»£ç†å…¨éƒ¨å¼€æºï¼ŒMIT è®¸å¯è¯
- **ğŸ§  å†…ç½®è®°å¿†ç³»ç»Ÿ**: è‡ªåŠ¨ç”Ÿæˆç”¨æˆ·åå¥½å’ŒèŠå¤©å†å²è®°å¿†
- **ğŸ“„ æ”¯æŒç°æœ‰æ–‡æ¡£**: å¯ä»¥ä»ç©ºç™½æ–‡æ¡£æˆ–ç°æœ‰ä»£ç å¼€å§‹åä½œ
- **ğŸ”„ å·¥ä»¶ç‰ˆæœ¬ç®¡ç†**: æ”¯æŒä»£ç å’Œæ–‡æ¡£çš„ç‰ˆæœ¬å†å²
- **ğŸ¨ å¤šæ ¼å¼æ”¯æŒ**: åŒæ—¶æ”¯æŒä»£ç ã€Markdown å’Œæ··åˆæ ¼å¼

### æ ¸å¿ƒåŠŸèƒ½

- **æ™ºèƒ½å¯¹è¯**: ä¸ AI åŠ©æ‰‹è¿›è¡Œè‡ªç„¶è¯­è¨€äº¤äº’
- **ä»£ç ç”Ÿæˆ**: ç”Ÿæˆã€ç¼–è¾‘å’Œä¼˜åŒ–ä»£ç 
- **æ–‡æ¡£åä½œ**: åˆ›å»ºå’Œç¼–è¾‘ Markdown æ–‡æ¡£
- **è®°å¿†ç³»ç»Ÿ**: è‡ªåŠ¨å­¦ä¹ å’Œè®°ä½ç”¨æˆ·åå¥½
- **å¿«é€Ÿæ“ä½œ**: é¢„å®šä¹‰å’Œè‡ªå®šä¹‰çš„å¿«é€Ÿæ“ä½œ
- **å®æ—¶æ¸²æŸ“**: è¾¹ç¼–è¾‘è¾¹é¢„è§ˆ Markdown æ•ˆæœ

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Open Canvas Platform                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Frontend (Next.js)        â”‚    Backend (LangGraph)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  React Components       â”‚ â”‚  â”‚  LangGraph Nodes        â”‚ â”‚
â”‚  â”‚  - Chat Interface       â”‚ â”‚  â”‚  - generatePath         â”‚ â”‚
â”‚  â”‚  - Model Selector       â”‚ â”‚  â”‚  - generateArtifact     â”‚ â”‚
â”‚  â”‚  - Artifact Editor      â”‚ â”‚  â”‚  - rewriteArtifact      â”‚ â”‚
â”‚  â”‚  - Canvas UI            â”‚ â”‚  â”‚  - updateArtifact       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  - reflect              â”‚ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  - generateFollowup     â”‚ â”‚
â”‚  â”‚  Context Providers      â”‚ â”‚  â”‚  - webSearch            â”‚ â”‚
â”‚  â”‚  - GraphContext         â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”‚  - ThreadProvider       â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  - UserContext          â”‚ â”‚  â”‚  LangChain Integration  â”‚ â”‚
â”‚  â”‚  - AssistantContext     â”‚ â”‚  â”‚  - Model Configuration  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  - Tool Binding         â”‚ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  - Message Handling     â”‚ â”‚
â”‚  â”‚  API Routes             â”‚ â”‚  â”‚  - API Calls            â”‚ â”‚
â”‚  â”‚  - Proxy to LangGraph   â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”‚  - Authentication       â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  - File Upload          â”‚ â”‚  â”‚  State Management       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  - Graph State          â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  - Memory Store         â”‚ â”‚
â”‚  â”‚  External Services      â”‚ â”‚  â”‚  - Thread Store         â”‚ â”‚
â”‚  â”‚  - Supabase (Auth/DB)   â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”‚  - LangSmith (Tracing)  â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  - Model Providers      â”‚ â”‚  â”‚  Multiple Graphs        â”‚ â”‚
â”‚  â”‚  - OpenAI, Anthropic    â”‚ â”‚  â”‚  - Main Agent Graph     â”‚ â”‚
â”‚  â”‚  - Google, Fireworks    â”‚ â”‚  â”‚  - Reflection Graph     â”‚ â”‚
â”‚  â”‚  - Groq, Ollama         â”‚ â”‚  â”‚  - Thread Title Graph   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  - Summarizer Graph     â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆ

#### å‰ç«¯æŠ€æœ¯
- **æ¡†æ¶**: Next.js 14 + React + TypeScript
- **æ ·å¼**: Tailwind CSS + Framer Motion
- **çŠ¶æ€ç®¡ç†**: React Context + Zustand
- **UI ç»„ä»¶**: Radix UI + è‡ªå®šä¹‰ç»„ä»¶
- **ç¼–è¾‘å™¨**: CodeMirror + BlockNote

#### åç«¯æŠ€æœ¯
- **å·¥ä½œæµå¼•æ“**: LangGraph
- **LLM é›†æˆ**: LangChain
- **è¿è¡Œæ—¶**: Node.js + TypeScript
- **æ•°æ®åº“**: Supabase PostgreSQL
- **è®¤è¯**: Supabase Auth

#### å¤–éƒ¨æœåŠ¡
- **æ¨¡å‹æä¾›å•†**: OpenAI, Anthropic, Google, Fireworks, Groq, Ollama
- **è¿½è¸ªæœåŠ¡**: LangSmith
- **æ–‡ä»¶å­˜å‚¨**: Supabase Storage

## ğŸ› ï¸ ç¯å¢ƒå‡†å¤‡

### ç³»ç»Ÿè¦æ±‚

- **Node.js**: 20.x æˆ–æ›´é«˜ç‰ˆæœ¬
- **åŒ…ç®¡ç†å™¨**: Yarn 1.22.22
- **æ“ä½œç³»ç»Ÿ**: Windows, macOS, Linux

### å¿…éœ€çš„æœåŠ¡å’Œ API å¯†é’¥

#### 1. è®¤è¯æœåŠ¡
- **Supabase**: ç”¨äºç”¨æˆ·è®¤è¯å’Œæ•°æ®åº“
  - åˆ›å»ºé¡¹ç›®: [https://supabase.com/dashboard/projects](https://supabase.com/dashboard/projects)
  - è·å– URL å’Œ API Key

#### 2. LLM æ¨¡å‹ API å¯†é’¥
- **OpenAI**: [https://platform.openai.com/signup/](https://platform.openai.com/signup/)
- **Anthropic**: [https://console.anthropic.com/](https://console.anthropic.com/)
- **Google GenAI**: [https://aistudio.google.com/apikey](https://aistudio.google.com/apikey) (å¯é€‰)
- **Fireworks AI**: [https://fireworks.ai/login](https://fireworks.ai/login) (å¯é€‰)
- **Groq AI**: [https://groq.com](https://groq.com) (å¯é€‰)

#### 3. å¯é€‰æœåŠ¡
- **LangSmith**: [https://smith.langchain.com/](https://smith.langchain.com/) (ç”¨äºè¿½è¸ªå’Œç›‘æ§)
- **FireCrawl**: [https://firecrawl.dev](https://firecrawl.dev) (ç”¨äºç½‘é¡µæŠ“å–)
- **ExaSearch**: [https://exa.ai](https://exa.ai) (ç”¨äºç½‘ç»œæœç´¢)

### å®‰è£…æ­¥éª¤

#### 1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/langchain-ai/open-canvas.git
cd open-canvas
```

#### 2. å®‰è£…ä¾èµ–
```bash
yarn install
```

#### 3. æ„å»ºé¡¹ç›®
```bash
yarn build
```

#### 4. é…ç½®ç¯å¢ƒå˜é‡

**æ ¹ç›®å½• `.env` æ–‡ä»¶** (LangGraph æœåŠ¡ä½¿ç”¨):
```bash
# å¿…éœ€ - LLM API å¯†é’¥
OPENAI_API_KEY=your_openai_api_key
ANTHROPIC_API_KEY=your_anthropic_api_key

# å¯é€‰ - å…¶ä»–æ¨¡å‹æä¾›å•†
GOOGLE_API_KEY=your_google_api_key
FIREWORKS_API_KEY=your_fireworks_api_key
GROQ_API_KEY=your_groq_api_key

# å¿…éœ€ - LangSmith è¿½è¸ª
LANGCHAIN_API_KEY=your_langsmith_api_key
LANGCHAIN_TRACING_V2=true
LANGCHAIN_PROJECT=open-canvas-local

# å¯é€‰ - æœ¬åœ°æ¨¡å‹
OLLAMA_API_URL=http://localhost:11434

# è°ƒè¯•æ¨¡å¼ (å¯é€‰)
BYPASS_AUTH=true
```

**`apps/web/.env` æ–‡ä»¶** (å‰ç«¯ä½¿ç”¨):
```bash
# å¿…éœ€ - Supabase é…ç½®
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE=your_supabase_service_role

# å¿…éœ€ - LangGraph API
LANGGRAPH_API_URL=http://localhost:54367

# å¯é€‰ - æ¨¡å‹å¯ç”¨æ§åˆ¶
NEXT_PUBLIC_OPENAI_ENABLED=true
NEXT_PUBLIC_ANTHROPIC_ENABLED=true
NEXT_PUBLIC_FIREWORKS_ENABLED=true
NEXT_PUBLIC_GROQ_ENABLED=true
NEXT_PUBLIC_GEMINI_ENABLED=true
NEXT_PUBLIC_OLLAMA_ENABLED=false

# è°ƒè¯•æ¨¡å¼ (å¯é€‰)
BYPASS_AUTH=true
```

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### 1. å¯åŠ¨ LangGraph æœåŠ¡

```bash
cd apps/agents
yarn dev
```

æœåŠ¡å¯åŠ¨åä¼šæ˜¾ç¤ºï¼š
```
Ready!
- ğŸš€ API: http://localhost:54367
- ğŸ¨ Studio UI: https://smith.langchain.com/studio?baseUrl=http://localhost:54367
```

### 2. å¯åŠ¨å‰ç«¯åº”ç”¨

```bash
cd apps/web
yarn dev
```

å‰ç«¯å¯åŠ¨åä¼šæ˜¾ç¤ºï¼š
```
- Local:        http://localhost:3000
- Network:      http://192.168.x.x:3000
```

### 3. è®¿é—®åº”ç”¨

æ‰“å¼€æµè§ˆå™¨è®¿é—® [http://localhost:3000](http://localhost:3000)

### 4. éªŒè¯åŠŸèƒ½

1. **è®¤è¯æµ‹è¯•**: æ³¨å†Œ/ç™»å½•è´¦æˆ·
2. **æ¨¡å‹æµ‹è¯•**: é€‰æ‹©ä¸åŒæ¨¡å‹è¿›è¡Œå¯¹è¯
3. **å·¥ä»¶ç”Ÿæˆ**: åˆ›å»ºä»£ç æˆ–æ–‡æ¡£
4. **è®°å¿†ç³»ç»Ÿ**: è§‚å¯Ÿ AI å¦‚ä½•è®°ä½ä½ çš„åå¥½

## ğŸ“š æ ¸å¿ƒæ¦‚å¿µ

### 1. LangGraph å·¥ä½œæµ

Open Canvas ä½¿ç”¨ LangGraph ç®¡ç†å¤æ‚çš„ AI å·¥ä½œæµï¼š

```typescript
// ä¸»å·¥ä½œæµå›¾
const builder = new StateGraph(OpenCanvasGraphAnnotation)
  .addNode("generatePath", generatePath)           // è·¯å¾„ç”Ÿæˆ
  .addNode("generateArtifact", generateArtifact)  // å·¥ä»¶ç”Ÿæˆ
  .addNode("rewriteArtifact", rewriteArtifact)    // å·¥ä»¶é‡å†™
  .addNode("updateArtifact", updateArtifact)      // å·¥ä»¶æ›´æ–°
  .addNode("generateFollowup", generateFollowup)  // åç»­ç”Ÿæˆ
  .addNode("reflect", reflectNode)                // åæ€èŠ‚ç‚¹
  .addNode("webSearch", webSearchGraph)           // ç½‘ç»œæœç´¢
```

### 2. å¤šå›¾åä½œ

é¡¹ç›®åŒ…å«å¤šä¸ªåä½œçš„ LangGraph å›¾ï¼š

- **ä¸»ä»£ç†å›¾** (`agent`): å¤„ç†ç”¨æˆ·äº¤äº’å’Œå·¥ä»¶ç”Ÿæˆ
- **åæ€å›¾** (`reflection`): ç”Ÿæˆç”¨æˆ·åå¥½è®°å¿†
- **æ ‡é¢˜ç”Ÿæˆå›¾** (`thread_title`): ä¸ºå¯¹è¯ç”Ÿæˆæ ‡é¢˜
- **æ‘˜è¦å›¾** (`summarizer`): ç”Ÿæˆå¯¹è¯æ‘˜è¦
- **ç½‘ç»œæœç´¢å›¾** (`web_search`): æ‰§è¡Œç½‘ç»œæœç´¢

### 3. çŠ¶æ€ç®¡ç†

#### å›¾çŠ¶æ€ (LangGraph)
```typescript
export const OpenCanvasGraphAnnotation = Annotation.Root({
  _messages: Annotation<BaseMessage[]>,     // æ¶ˆæ¯å†å²
  artifact: Annotation<ArtifactV3>,         // å½“å‰å·¥ä»¶
  highlightedCode: Annotation<CodeHighlight>, // é«˜äº®ä»£ç 
  highlightedText: Annotation<TextHighlight>, // é«˜äº®æ–‡æœ¬
  next: Annotation<string>,                 // ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
  // ... æ›´å¤šçŠ¶æ€
});
```

#### å‰ç«¯çŠ¶æ€ (React Context)
```typescript
// GraphContext - ç®¡ç†å›¾æ‰§è¡ŒçŠ¶æ€
interface GraphData {
  runId: string;
  isStreaming: boolean;
  messages: BaseMessage[];
  artifact: ArtifactV3;
  // ... æ›´å¤šçŠ¶æ€
}

// ThreadProvider - ç®¡ç†çº¿ç¨‹å’Œæ¨¡å‹é…ç½®
interface ThreadContentType {
  threadId: string;
  modelName: ALL_MODEL_NAMES;
  modelConfigs: Record<ALL_MODEL_NAMES, CustomModelConfig>;
  // ... æ›´å¤šçŠ¶æ€
}
```

### 4. æ¨¡å‹é…ç½®ç³»ç»Ÿ

ç»Ÿä¸€çš„æ¨¡å‹é…ç½®æ¥å£æ”¯æŒå¤šç§æä¾›å•†ï¼š

```typescript
// æ¨¡å‹é…ç½®ç¤ºä¾‹
const modelConfig = {
  modelName: "gpt-4o",
  modelProvider: "openai",
  apiKey: process.env.OPENAI_API_KEY,
  temperature: 0.5,
  maxTokens: 4096
};
```

æ”¯æŒçš„æ¨¡å‹æä¾›å•†ï¼š
- **OpenAI**: GPT-4o, GPT-4o Mini, o1 ç³»åˆ—
- **Anthropic**: Claude 3.5 Sonnet, Claude 3 Haiku
- **Google**: Gemini 2.0 Flash, Gemini Pro
- **Fireworks**: Llama 3.3 70B, DeepSeek V3
- **Groq**: DeepSeek R1, Llama 3.1
- **Azure OpenAI**: ä¼ä¸šçº§éƒ¨ç½²
- **Ollama**: æœ¬åœ°éƒ¨ç½²æ¨¡å‹

## ğŸ’» å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
open-canvas/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ web/                 # Next.js å‰ç«¯åº”ç”¨
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ app/         # Next.js App Router
â”‚   â”‚   â”‚   â”œâ”€â”€ components/  # React ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ contexts/    # React Context
â”‚   â”‚   â”‚   â”œâ”€â”€ hooks/       # è‡ªå®šä¹‰ Hooks
â”‚   â”‚   â”‚   â””â”€â”€ lib/         # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â””â”€â”€ agents/              # LangGraph åç«¯æœåŠ¡
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ open-canvas/ # ä¸»ä»£ç†å›¾
â”‚       â”‚   â”œâ”€â”€ reflection/  # åæ€å›¾
â”‚       â”‚   â”œâ”€â”€ thread-title/# æ ‡é¢˜ç”Ÿæˆå›¾
â”‚       â”‚   â”œâ”€â”€ summarizer/  # æ‘˜è¦å›¾
â”‚       â”‚   â”œâ”€â”€ web-search/  # ç½‘ç»œæœç´¢å›¾
â”‚       â”‚   â””â”€â”€ utils.ts     # å·¥å…·å‡½æ•°
â”‚       â””â”€â”€ package.json
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ shared/              # å…±äº«ç±»å‹å’Œå¸¸é‡
â”‚   â””â”€â”€ evals/               # è¯„ä¼°å·¥å…·
â”œâ”€â”€ langgraph.json           # LangGraph é…ç½®
â””â”€â”€ package.json             # æ ¹é…ç½®
```

### å¼€å‘å·¥ä½œæµ

#### 1. æ·»åŠ æ–°æ¨¡å‹

**æ­¥éª¤ 1**: åœ¨ `packages/shared/src/models.ts` ä¸­æ·»åŠ æ¨¡å‹å®šä¹‰
```typescript
export const NEW_MODEL: ModelConfig = {
  name: "new-model",
  displayName: "New Model",
  provider: "new-provider",
  // ... å…¶ä»–é…ç½®
};
```

**æ­¥éª¤ 2**: åœ¨ `apps/agents/src/utils.ts` ä¸­æ·»åŠ æä¾›å•†æ”¯æŒ
```typescript
if (customModelName.includes("new-provider/")) {
  return {
    modelName: actualModelName,
    modelProvider: "new-provider",
    apiKey: process.env.NEW_PROVIDER_API_KEY,
  };
}
```

**æ­¥éª¤ 3**: å®‰è£…å¿…è¦çš„ä¾èµ–åŒ…
```bash
cd apps/agents
yarn add @langchain/new-provider
```

**æ­¥éª¤ 4**: é…ç½®ç¯å¢ƒå˜é‡
```bash
NEW_PROVIDER_API_KEY=your_api_key
NEXT_PUBLIC_NEW_PROVIDER_ENABLED=true
```

#### 2. æ·»åŠ æ–°èŠ‚ç‚¹

**æ­¥éª¤ 1**: åœ¨ `apps/agents/src/open-canvas/nodes/` ä¸­åˆ›å»ºèŠ‚ç‚¹æ–‡ä»¶
```typescript
// apps/agents/src/open-canvas/nodes/new-node/index.ts
export const newNode = async (
  state: typeof OpenCanvasGraphAnnotation.State,
  config: LangGraphRunnableConfig
): Promise<OpenCanvasGraphReturnType> => {
  // èŠ‚ç‚¹é€»è¾‘
  const model = await getModelFromConfig(config);
  const response = await model.invoke([...messages]);
  
  return {
    // çŠ¶æ€æ›´æ–°
  };
};
```

**æ­¥éª¤ 2**: åœ¨ `apps/agents/src/open-canvas/index.ts` ä¸­æ³¨å†ŒèŠ‚ç‚¹
```typescript
const builder = new StateGraph(OpenCanvasGraphAnnotation)
  .addNode("newNode", newNode)
  // ... å…¶ä»–èŠ‚ç‚¹
```

**æ­¥éª¤ 3**: é…ç½®èŠ‚ç‚¹é—´çš„è¾¹å’Œè·¯ç”±
```typescript
.addEdge("existingNode", "newNode")
.addConditionalEdges("newNode", routeFunction, ["nextNode1", "nextNode2"])
```

#### 3. æ·»åŠ æ–°å·¥å…·

**æ­¥éª¤ 1**: å®šä¹‰å·¥å…·æ¨¡å¼
```typescript
const NEW_TOOL_SCHEMA = z.object({
  parameter: z.string().describe("å·¥å…·å‚æ•°"),
  // ... å…¶ä»–å‚æ•°
});
```

**æ­¥éª¤ 2**: åœ¨èŠ‚ç‚¹ä¸­ç»‘å®šå·¥å…·
```typescript
const modelWithTool = model.bindTools([
  {
    name: "new_tool",
    description: "å·¥å…·æè¿°",
    schema: NEW_TOOL_SCHEMA,
  }
]);
```

**æ­¥éª¤ 3**: å¤„ç†å·¥å…·è°ƒç”¨ç»“æœ
```typescript
const response = await modelWithTool.invoke([...messages]);
const toolCall = response.tool_calls?.[0];
if (toolCall?.name === "new_tool") {
  const args = toolCall.args;
  // å¤„ç†å·¥å…·è°ƒç”¨
}
```

### è°ƒè¯•æŠ€å·§

#### 1. ä½¿ç”¨ LangGraph Studio

è®¿é—® [https://smith.langchain.com/studio?baseUrl=http://localhost:54367](https://smith.langchain.com/studio?baseUrl=http://localhost:54367) è¿›è¡Œå¯è§†åŒ–è°ƒè¯•ã€‚

#### 2. æ§åˆ¶å°æ—¥å¿—

åœ¨èŠ‚ç‚¹ä¸­æ·»åŠ è°ƒè¯•æ—¥å¿—ï¼š
```typescript
console.log("èŠ‚ç‚¹æ‰§è¡Œå¼€å§‹", { state, config });
console.log("æ¨¡å‹å“åº”", response);
```

#### 3. LangSmith è¿½è¸ª

è®¾ç½®ç¯å¢ƒå˜é‡å¯ç”¨è¿½è¸ªï¼š
```bash
LANGCHAIN_TRACING_V2=true
LANGCHAIN_PROJECT=debug-project
```

#### 4. VS Code è°ƒè¯•

é…ç½® `.vscode/launch.json`:
```json
{
  "name": "Debug LangGraph Agents",
  "type": "node",
  "request": "launch",
  "program": "${workspaceFolder}/debug-agents.js",
  "console": "integratedTerminal"
}
```

## â“ å¸¸è§é—®é¢˜

### 1. å¯åŠ¨é—®é¢˜

**Q: LangGraph æœåŠ¡å¯åŠ¨å¤±è´¥**
```bash
# æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
netstat -ano | findstr :54367

# æ€æ­»å ç”¨è¿›ç¨‹
taskkill /PID <PID> /F
```

**Q: å‰ç«¯æ— æ³•è¿æ¥åˆ°åç«¯**
- ç¡®è®¤ LangGraph æœåŠ¡æ­£åœ¨è¿è¡Œ
- æ£€æŸ¥ `LANGGRAPH_API_URL` ç¯å¢ƒå˜é‡
- ç¡®è®¤é˜²ç«å¢™è®¾ç½®

**Q: è®¤è¯å¤±è´¥**
- æ£€æŸ¥ Supabase é…ç½®
- ç¡®è®¤ç¯å¢ƒå˜é‡æ­£ç¡®è®¾ç½®
- å°è¯•è®¾ç½® `BYPASS_AUTH=true` è¿›è¡Œè°ƒè¯•

### 2. æ¨¡å‹é—®é¢˜

**Q: æ¨¡å‹è°ƒç”¨å¤±è´¥**
- æ£€æŸ¥ API å¯†é’¥æ˜¯å¦æ­£ç¡®
- ç¡®è®¤æ¨¡å‹æä¾›å•†æœåŠ¡çŠ¶æ€
- æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯æ—¥å¿—

**Q: å·¥å…·è°ƒç”¨å¤±è´¥**
- ç¡®è®¤æ¨¡å‹æ”¯æŒå·¥å…·è°ƒç”¨
- æ£€æŸ¥å·¥å…·æ¨¡å¼å®šä¹‰
- æŸ¥çœ‹ LangSmith è¿½è¸ªæ—¥å¿—

### 3. å¼€å‘é—®é¢˜

**Q: TypeScript ç±»å‹é”™è¯¯**
```bash
# é‡æ–°æ„å»ºé¡¹ç›®
yarn build

# æ£€æŸ¥ç±»å‹å®šä¹‰
yarn tsc --noEmit
```

**Q: ä¾èµ–å†²çª**
```bash
# æ¸…ç†å¹¶é‡æ–°å®‰è£…
rm -rf node_modules yarn.lock
yarn install
```

**Q: çƒ­é‡è½½ä¸å·¥ä½œ**
- é‡å¯å¼€å‘æœåŠ¡å™¨
- æ£€æŸ¥æ–‡ä»¶ç›‘å¬è®¾ç½®
- ç¡®è®¤æ–‡ä»¶ä¿å­˜

### 4. æ€§èƒ½é—®é¢˜

**Q: å“åº”é€Ÿåº¦æ…¢**
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- å°è¯•ä¸åŒçš„æ¨¡å‹
- ä¼˜åŒ–æç¤ºè¯é•¿åº¦

**Q: å†…å­˜ä½¿ç”¨è¿‡é«˜**
- æ£€æŸ¥çŠ¶æ€ç®¡ç†
- ä¼˜åŒ–æ¶ˆæ¯å†å²é•¿åº¦
- ä½¿ç”¨æµå¼å¤„ç†

## ğŸ”§ è¿›é˜¶å®šåˆ¶

### 1. è‡ªå®šä¹‰ UI ç»„ä»¶

**æ·»åŠ æ–°ç»„ä»¶**:
```typescript
// apps/web/src/components/custom/MyComponent.tsx
export const MyComponent = () => {
  return (
    <div className="my-custom-component">
      {/* ç»„ä»¶å†…å®¹ */}
    </div>
  );
};
```

**é›†æˆåˆ°ç°æœ‰ç•Œé¢**:
```typescript
// åœ¨ç°æœ‰ç»„ä»¶ä¸­å¯¼å…¥å’Œä½¿ç”¨
import { MyComponent } from "@/components/custom/MyComponent";
```

### 2. è‡ªå®šä¹‰å·¥ä½œæµ

**åˆ›å»ºæ–°çš„å›¾**:
```typescript
// apps/agents/src/custom-graph/index.ts
export const customGraph = new StateGraph(CustomGraphAnnotation)
  .addNode("start", startNode)
  .addNode("process", processNode)
  .addNode("end", endNode)
  .addEdge("start", "process")
  .addEdge("process", "end");
```

**æ³¨å†Œåˆ° LangGraph**:
```json
// langgraph.json
{
  "graphs": {
    "custom": "./apps/agents/src/custom-graph/index.ts:customGraph"
  }
}
```

### 3. é›†æˆå¤–éƒ¨æœåŠ¡

**æ·»åŠ æ–°çš„ API é›†æˆ**:
```typescript
// apps/agents/src/integrations/new-service.ts
export class NewServiceIntegration {
  async callAPI(params: any) {
    const response = await fetch('https://api.newservice.com', {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${process.env.NEW_SERVICE_API_KEY}`,
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(params),
    });
    return response.json();
  }
}
```

### 4. éƒ¨ç½²é…ç½®

**Docker éƒ¨ç½²**:
```dockerfile
FROM node:20-alpine
WORKDIR /app
COPY package*.json ./
RUN yarn install
COPY . .
RUN yarn build
EXPOSE 3000 54367
CMD ["yarn", "start"]
```

**ç¯å¢ƒå˜é‡ç®¡ç†**:
```bash
# ç”Ÿäº§ç¯å¢ƒé…ç½®
NODE_ENV=production
LANGGRAPH_API_URL=https://your-domain.com
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
```

### 5. ç›‘æ§å’Œæ—¥å¿—

**æ·»åŠ è‡ªå®šä¹‰ç›‘æ§**:
```typescript
// apps/agents/src/monitoring/custom-metrics.ts
export const trackCustomMetric = (metric: string, value: number) => {
  // å‘é€åˆ°ç›‘æ§æœåŠ¡
  console.log(`Metric: ${metric}, Value: ${value}`);
};
```

**ç»“æ„åŒ–æ—¥å¿—**:
```typescript
// ä½¿ç”¨ç»“æ„åŒ–æ—¥å¿—
console.log(JSON.stringify({
  timestamp: new Date().toISOString(),
  level: 'info',
  message: 'Node executed',
  nodeName: 'generateArtifact',
  duration: 1500,
}));
```

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [æŠ€æœ¯æ¶æ„æ€»è§ˆ](./æŠ€æœ¯æ¶æ„æ€»è§ˆ.md) - è¯¦ç»†çš„æ¶æ„åˆ†æ
- [LangChain ä¸ LangGraph å…³ç³»åˆ†æ](./LangChainä¸LangGraphå…³ç³»åˆ†æ.md) - æ¡†æ¶åä½œæœºåˆ¶
- [æ¨¡å‹é…ç½®ä¸ API ç«¯ç‚¹åˆ†æ](./æ¨¡å‹é…ç½®ä¸APIç«¯ç‚¹åˆ†æ.md) - æ¨¡å‹é›†æˆæŒ‡å—
- [DashScope é…ç½®è¯´æ˜](./DashScopeé…ç½®è¯´æ˜.md) - é˜¿é‡Œäº‘æ¨¡å‹é…ç½®

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘æµç¨‹

1. **Fork é¡¹ç›®**: åˆ›å»ºè‡ªå·±çš„åˆ†æ”¯
2. **åˆ›å»ºåŠŸèƒ½åˆ†æ”¯**: `git checkout -b feature/new-feature`
3. **å¼€å‘åŠŸèƒ½**: ç¼–å†™ä»£ç å’Œæµ‹è¯•
4. **æäº¤æ›´æ”¹**: `git commit -m "Add new feature"`
5. **æ¨é€åˆ†æ”¯**: `git push origin feature/new-feature`
6. **åˆ›å»º PR**: æäº¤ Pull Request

### ä»£ç è§„èŒƒ

- ä½¿ç”¨ TypeScript è¿›è¡Œç±»å‹å®‰å…¨å¼€å‘
- éµå¾ª ESLint å’Œ Prettier é…ç½®
- ç¼–å†™æ¸…æ™°çš„æ³¨é‡Šå’Œæ–‡æ¡£
- ä¿æŒä»£ç çš„æ¨¡å—åŒ–å’Œå¯æµ‹è¯•æ€§

### æµ‹è¯•è¦æ±‚

- ä¸ºæ–°åŠŸèƒ½ç¼–å†™å•å…ƒæµ‹è¯•
- ç¡®ä¿é›†æˆæµ‹è¯•çš„è¦†ç›–ç‡
- è¿›è¡Œç«¯åˆ°ç«¯æµ‹è¯•éªŒè¯

---

## ğŸ“ è·å–å¸®åŠ©

- **GitHub Issues**: [é¡¹ç›® Issues é¡µé¢](https://github.com/langchain-ai/open-canvas/issues)
- **æŠ€æœ¯è®¨è®º**: [é¡¹ç›® Discussions é¡µé¢](https://github.com/langchain-ai/open-canvas/discussions)
- **å®˜æ–¹æ–‡æ¡£**: [LangChain æ–‡æ¡£](https://langchain-ai.github.io/langgraphjs/)

---

*æœ€åæ›´æ–°æ—¶é—´: 2024å¹´12æœˆ*

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼ğŸ‰**
