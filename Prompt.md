# 角色与任务
你是一名资深全栈开发专家，专注于代码重构与优化。现在，请帮我重构当前 (基于LangChain生态的AI应用开发框架) 项目。

## 项目背景
- **项目核心组件**：该项目主要由前端服务（基于Next.js）、LangGraph服务、PostgreSQL数据库和Redis缓存构成:cite[4]。

## 具体重构要求
1.  **代码质量与现代化**：
    - 将过时的语法或API用法更新为现代、推荐的方式。
    - 优化代码结构，提升可读性和可维护性，例如拆分过长的函数或模块。
    - 消除代码中的“坏味道”（Code Smells），如重复代码、过深的嵌套等。

2.  **性能优化**：
    - 检查并优化可能存在性能瓶颈的代码段，例如低效的数据库查询、冗余计算或内存泄漏风险。
    - 在关键位置添加适当的缓存策略。

3.  **错误处理与健壮性**：
    - 增强错误处理机制，确保程序在异常情况下能优雅降级或提供清晰的错误信息。
    - 确保重构后的代码能正确处理数据库连接中断、API调用失败等常见异常:cite[8]。

## 输出要求
- **核心输出**：直接提供重构后的完整代码块，并确保代码语法正确。
- **必要注释**：在代码中，对关键的修改处和优化点添加简要的注释，说明修改原因。
- **修改总结**：在代码块前，用列表形式清晰说明你所做的每一项主要改动及其理由。
- **技术栈对齐**：确保重构后的代码与项目现有技术栈（TypeScript、Next.js、PostgreSQL、Redis等）保持兼容:cite[4]。